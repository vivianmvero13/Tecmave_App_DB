// Language toggle without fetch - works even from file://
// Uses a <select id="language-select"> (if present) and data-key attributes.
document.addEventListener('DOMContentLoaded', () => {
  const languageSelect = document.getElementById('language-select');

  const translations = {
  "es": {
    "nav_home": "Inicio",
    "nav_services": "Servicios",
    "nav_about": "Nosotros",
    "nav_testimonials": "Testimonios",
    "nav_contact": "Contacto",
    "nav_phone": "+506 2222-3333",
    "nav_login": "Acceder",
    "hero_badge": "★ TALLER CERTIFICADO",
    "hero_title": "Expertos en Servicios Automotrices",
    "hero_subtitle": "Más de 15 años brindando soluciones confiables para tu vehículo. Tecnología de vanguardia y atención personalizada.",
    "stat_experience": "Años Experiencia",
    "stat_repaired": "Vehículos Reparados",
    "stat_crane": "Servicio de Grúa",
    "hero_button_schedule": "AGENDAR CITA",
    "hero_button_call": "LLAMAR AHORA",
    "free_diagnostic": "Diagnóstico Gratis",
    "free_diagnostic_desc": "Evaluación completa sin costo",
    "services_title": "Nuestros Servicios",
    "services_subtitle": "Soluciones integrales para el cuidado de tu vehículo",
    "service_1_title": "Mecánica General",
    "service_1_desc": "Reparación y mantenimiento completo del motor y sistemas mecánicos",
    "service_1_feature_1": "Cambio de aceite",
    "service_1_feature_2": "Reparación de motor",
    "service_1_feature_3": "Sistema de frenos",
    "service_1_feature_4": "Suspensión",
    "service_2_title": "Diagnóstico Computarizado",
    "service_2_desc": "Tecnología avanzada para identificar problemas electrónicos",
    "service_2_feature_1": "Escaneo computarizado",
    "service_2_feature_2": "Programación de módulos",
    "service_2_feature_3": "Reparación eléctrica",
    "service_2_feature_4": "Actualizaciones",
    "service_3_title": "Electricidad Automotriz",
    "service_3_desc": "Especialistas en sistemas eléctricos y electrónicos",
    "service_3_feature_1": "Sistema de carga",
    "service_3_feature_2": "Iluminación y luces",
    "service_3_feature_3": "Centrales y módulos",
    "service_3_feature_4": "Instalación",
    "know_more": "Saber Más",
    "about_title": "Sobre Nosotros",
    "about_p1": "En Tecmave nos dedicamos a brindar servicios automotrices de la más alta calidad. Con más de 15 años de experiencia, hemos establecido un estándar de excelencia en el cuidado y mantenimiento de vehículos.",
    "about_p2": "Nuestro equipo de técnicos certificados está comprometido con ofrecer soluciones confiables y eficientes para todas las marcas y modelos de vehículos.",
    "about_feature_1": "Certificación internacional",
    "about_feature_2": "Equipo especializado",
    "about_feature_3": "Garantía en todos los servicios",
    "testimonials_title": "Lo que dicen nuestros clientes",
    "testimonials_subtitle": "Experiencias reales de clientes satisfechos",
    "cta_title": "¿Necesitas ayuda con tu vehículo?",
    "cta_subtitle": "Contáctanos hoy mismo y recibe una cotización gratuita",
    "admin_title": "Administración",
    "income_assistance": "Ingresos por asistencia",
    "from": "Desde",
    "to": "Hasta",
    "type": "Tipo",
    "all": "Todos",
    "assistance": "Asistencia",
    "maintenance": "Mantenimiento",
    "query": "Consultar",
    "export_excel": "Exportar Excel",
    "export_pdf": "Exportar PDF",
    "plate_history": "Historial por placa",
    "plate": "Placa",
    "search": "Buscar",
    "date_income": "Fecha ingreso",
    "service": "Servicio",
    "status": "Estado",
    "employees_roles": "Empleados y roles",
    "manage_employees": "Gestionar empleados",
    "manage_roles": "Gestionar roles",
    "payroll": "Planilla",
    "employee": "Empleado",
    "hours": "Horas",
    "period": "Período",
    "adjustments": "Ajustes",
    "generate_payroll": "Generar planilla",
    "login_left_title": "Tecmave taller Automotriz",
    "login_left_caption": "TUS FUTURUS PRODUCTOS ESTAN AL ALCANCE DE TU MANO.",
    "login_title": "Login",
    "login_subtitle": "SEA BIENVENIDO DE VUELTA AMIGO.",
    "login_label_email": "User  Name",
    "login_label_password": "Password",
    "login_button": "Login",
    "login_link_register": "¿No tienes cuenta? Crear cuenta",
    "login_demo": "Demo admin: admin@tecmave.com / Admin1234",
    "register_left_title": "Dynamic Table Talkie",
    "register_left_caption": "You can feature your product’s ads on it as well.",
    "register_title": "Crear Cuenta",
    "register_subtitle": "Regístrate para acceder a todos los servicios",
    "register_label_name": "Nombre Completo",
    "register_label_email": "Correo Electrónico",
    "register_label_password": "Contraseña",
    "register_button": "Crear Cuenta",
    "register_link_login": "¿Ya tienes cuenta? Inicia Sesión",
    "register_access_policy_title": "Política de acceso:",
    "register_access_admins": "Admins solo con @tecmave.com",
    "register_access_clients": "Clientes con @gmail.com",
    "clients_quick_access": "Acceso rápido",
    "clients_my_vehicles": "Mis vehículos",
    "label_plate": "Placa",
    "label_brand": "Marca",
    "btn_associate": "Asociar",
    "th_plate": "Placa",
    "th_vehicle": "Vehículo",
    "th_status": "Estado",
    "status_in_service": "En servicio",
    "agenda_new_appointment": "Nueva cita",
    "label_name": "Nombre",
    "label_email": "Correo",
    "label_date": "Fecha",
    "label_time": "Hora",
    "btn_schedule": "Agendar",
    "agenda_service_status": "Estado del servicio",
    "th_checkin": "Ingreso",
    "th_estimated_delivery": "Entrega estimada",
    "status_ready": "Listo",
    "btn_activate_6m": "Activar 6 meses",
    "services_suggested_price_title": "Precio sugerido",
    "label_mileage": "Kilometraje",
    "label_suggested_price": "Precio sugerido",
    "services_illustrative_values": "Valores ilustrativos.",
    "services_corrective_title": "Correctivo",
    "label_vehicle": "Vehículo",
    "label_description": "Descripción",
    "btn_register": "Registrar",
    "sidebar_management": "Gestión",
    "card_management": "Gestión",
    "card_search": "Buscar",
    "fact_new_invoice": "Nueva factura",
    "fact_query_status": "Consulta y estado",
    "stats_date_range": "Rango de Fechas",
    "stats_service_type": "Tipo de Servicio",
    "stats_main_metric": "Métrica Principal",
    "stats_total_income": "Ingresos Totales",
    "stats_completed_appointments": "Citas Completadas",
    "stats_new_clients": "Nuevos Clientes",
    "stats_avg_time": "Tiempo Promedio",
    "stats_services_flow": "Flujo de Servicios",
    "stats_client_retention": "Retención de Clientes",
    "stats_detailed_data": "Datos Detallados",
    "stats_trans_volume": "Volumen de Transacciones",
    "stats_popular_services": "Servicios Populares",
    "modal_chart_title": "Gráfico Ampliado",
    "btn_update": "Actualizar",
    "btn_delete": "Eliminar",
    "btn_generate": "Generar",
    "btn_save": "Guardar",
    "veh_register_title": "Registrar vehículo",
    "veh_status_details_title": "Estado y detalles",
    "veh_no_maintenance": "No hay vehículos en mantenimiento actualmente.",
    "status_finished": "Finalizado",
    "btn_view_details": "Ver detalles",
    "client_today_title": "Tu taller hoy",
    "client_next_appointment": "Próxima cita",
    "client_my_vehicles_label": "Mis vehículos",
    "client_in_workshop": "2 en taller",
    "client_month_balance": "Balance del mes",
    "client_paid": "Pagado",
    "status_pending": "Pendiente",
    "status_paid": "Pagada",
    "status_cancelled": "Anulada",
    "th_client": "Cliente",
    "th_amount": "Monto",
    "th_progress": "Progreso"
  },
  "en": {
    "nav_home": "Home",
    "nav_services": "Services",
    "nav_about": "About Us",
    "nav_testimonials": "Testimonials",
    "nav_contact": "Contact",
    "nav_phone": "+506 2222-3333",
    "nav_login": "Login",
    "hero_badge": "★ CERTIFIED WORKSHOP",
    "hero_title": "Experts in Automotive Services",
    "hero_subtitle": "Over 15 years providing reliable solutions for your vehicle. Cutting-edge technology and personalized attention.",
    "stat_experience": "Years of Experience",
    "stat_repaired": "Vehicles Repaired",
    "stat_crane": "Crane Service",
    "hero_button_schedule": "SCHEDULE APPOINTMENT",
    "hero_button_call": "CALL NOW",
    "free_diagnostic": "Free Diagnostic",
    "free_diagnostic_desc": "Complete evaluation at no cost",
    "services_title": "Our Services",
    "services_subtitle": "Comprehensive solutions for the care of your vehicle",
    "service_1_title": "General Mechanics",
    "service_1_desc": "Complete repair and maintenance of the engine and mechanical systems",
    "service_1_feature_1": "Oil change",
    "service_1_feature_2": "Engine repair",
    "service_1_feature_3": "Brake system",
    "service_1_feature_4": "Suspension",
    "service_2_title": "Computerized Diagnostic",
    "service_2_desc": "Advanced technology to identify electronic problems",
    "service_2_feature_1": "Computerized scanning",
    "service_2_feature_2": "Module programming",
    "service_2_feature_3": "Electrical repair",
    "service_2_feature_4": "Updates",
    "service_3_title": "Automotive Electricity",
    "service_3_desc": "Specialists in electrical and electronic systems",
    "service_3_feature_1": "Charging system",
    "service_3_feature_2": "Lighting and lights",
    "service_3_feature_3": "Control units and modules",
    "service_3_feature_4": "Installation",
    "know_more": "Know More",
    "about_title": "About Us",
    "about_p1": "At Tecmave, we are dedicated to providing the highest quality automotive services. With over 15 years of experience, we have established a standard of excellence in vehicle care and maintenance.",
    "about_p2": "Our team of certified technicians is committed to offering reliable and efficient solutions for all vehicle makes and models.",
    "about_feature_1": "International certification",
    "about_feature_2": "Specialized team",
    "about_feature_3": "Warranty on all services",
    "testimonials_title": "What our clients say",
    "testimonials_subtitle": "Real experiences from satisfied customers",
    "cta_title": "Need help with your vehicle?",
    "cta_subtitle": "Contact us today and receive a free quote",
    "admin_title": "Administration",
    "income_assistance": "Income from assistance",
    "from": "From",
    "to": "To",
    "type": "Type",
    "all": "All",
    "assistance": "Assistance",
    "maintenance": "Maintenance",
    "query": "Query",
    "export_excel": "Export Excel",
    "export_pdf": "Export PDF",
    "plate_history": "History by plate",
    "plate": "Plate",
    "search": "Search",
    "date_income": "Income date",
    "service": "Service",
    "status": "Status",
    "employees_roles": "Employees and roles",
    "manage_employees": "Manage employees",
    "manage_roles": "Manage roles",
    "payroll": "Payroll",
    "employee": "Employee",
    "hours": "Hours",
    "period": "Period",
    "adjustments": "Adjustments",
    "generate_payroll": "Generate payroll",
    "login_left_title": "Tecmave Automotive Workshop",
    "login_left_caption": "YOUR FUTURE PRODUCTS ARE WITHIN YOUR REACH.",
    "login_title": "Login",
    "login_subtitle": "WELCOME BACK, FRIEND.",
    "login_label_email": "User Name",
    "login_label_password": "Password",
    "login_button": "Login",
    "login_link_register": "Don't have an account? Create one",
    "login_demo": "Demo admin: admin@tecmave.com / Admin1234",
    "register_left_title": "Dynamic Table Talkie",
    "register_left_caption": "You can feature your product’s ads on it as well.",
    "register_title": "Create Account",
    "register_subtitle": "Register to access all services",
    "register_label_name": "Full Name",
    "register_label_email": "Email Address",
    "register_label_password": "Password",
    "register_button": "Create Account",
    "register_link_login": "Already have an account? Sign in",
    "register_access_policy_title": "Access policy:",
    "register_access_admins": "Admins only with @tecmave.com",
    "register_access_clients": "Clients with @gmail.com",
    "clients_quick_access": "Quick access",
    "clients_my_vehicles": "My vehicles",
    "label_plate": "License plate",
    "label_brand": "Brand",
    "btn_associate": "Link vehicle",
    "th_plate": "Plate",
    "th_vehicle": "Vehicle",
    "th_status": "Status",
    "status_in_service": "In service",
    "agenda_new_appointment": "New appointment",
    "label_name": "Name",
    "label_email": "Email",
    "label_date": "Date",
    "label_time": "Time",
    "btn_schedule": "Schedule",
    "agenda_service_status": "Service status",
    "th_checkin": "Check-in",
    "th_estimated_delivery": "Estimated delivery",
    "status_ready": "Ready",
    "btn_activate_6m": "Activate 6 months",
    "services_suggested_price_title": "Suggested price",
    "label_mileage": "Mileage",
    "label_suggested_price": "Suggested price",
    "services_illustrative_values": "Illustrative values.",
    "services_corrective_title": "Corrective",
    "label_vehicle": "Vehicle",
    "label_description": "Description",
    "btn_register": "Register",
    "sidebar_management": "Management",
    "card_management": "Management",
    "card_search": "Search",
    "fact_new_invoice": "New invoice",
    "fact_query_status": "Query & status",
    "stats_date_range": "Date range",
    "stats_service_type": "Service type",
    "stats_main_metric": "Main metric",
    "stats_total_income": "Total income",
    "stats_completed_appointments": "Completed appointments",
    "stats_new_clients": "New clients",
    "stats_avg_time": "Average time",
    "stats_services_flow": "Service flow",
    "stats_client_retention": "Client retention",
    "stats_detailed_data": "Detailed data",
    "stats_trans_volume": "Transaction volume",
    "stats_popular_services": "Popular services",
    "modal_chart_title": "Expanded chart",
    "btn_update": "Update",
    "btn_delete": "Delete",
    "btn_generate": "Generate",
    "btn_save": "Save",
    "veh_register_title": "Register vehicle",
    "veh_status_details_title": "Status & details",
    "veh_no_maintenance": "There are no vehicles currently under maintenance.",
    "status_finished": "Finished",
    "btn_view_details": "View details",
    "client_today_title": "Your workshop today",
    "client_next_appointment": "Next appointment",
    "client_my_vehicles_label": "My vehicles",
    "client_in_workshop": "2 in workshop",
    "client_month_balance": "Monthly balance",
    "client_paid": "Paid",
    "status_pending": "Pending",
    "status_paid": "Paid",
    "status_cancelled": "Cancelled",
    "th_client": "Client",
    "th_amount": "Amount",
    "th_progress": "Progress"
  }
};

  function setLanguage(lang) {
    const langCode = translations[lang] ? lang : 'es';
    localStorage.setItem('language', langCode);
    if (languageSelect) languageSelect.value = langCode;
    translatePage(langCode);
  }

  function translatePage(lang) {
    const dict = translations[lang];
    if (!dict) return;

    document.querySelectorAll('[data-key]').forEach(el => {
      const key = el.getAttribute('data-key');
      const value = dict[key];
      if (!value) return;

      // Inputs / textareas: placeholder
      if ((el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') && el.hasAttribute('placeholder')) {
        el.setAttribute('placeholder', value);
        return;
      }

      // Preserve children, only replace main text node when existe
      const childNodes = Array.from(el.childNodes);
      const textNode = childNodes.find(
        n => n.nodeType === Node.TEXT_NODE && n.textContent.trim().length > 0
      );
      if (textNode) {
        textNode.textContent = value;
      } else {
        el.textContent = value;
      }
    });
  }

  if (languageSelect) {
    languageSelect.addEventListener('change', (e) => setLanguage(e.target.value));
  }

  const saved = localStorage.getItem('language') || 'es';
  setLanguage(saved);
}),
    "recent_activity": { "es":"Actividad Reciente","en":"Recent Activity"},
    "payments_metrics": {"es":"Métricas de Pagos","en":"Payment Metrics"},
    "general_overview":{"es":"Visión General","en":"General Overview"}

}