@page
@model Front.Pages.Contacto.IndexModel
@{
    ViewData["Title"] = "Contacto";
}

<section class="section">
    <div class="container grid cols-2">
        <div class="card">
            <h3>Escríbenos</h3>
            <div class="form-row">
                <div>
                    <label>Nombre</label>
                    <input class="input" id="contacto-nombre" placeholder="Tu nombre" />
                </div>
            </div>
            <div class="form-row">
                <div>
                    <label>Email</label>
                    <input class="input" id="contacto-email" type="email" placeholder="correo@dominio.com" />
                </div>
            </div>
            <div class="form-row">
                <div>
                    <label>Mensaje</label>
                    <textarea class="input" id="contacto-mensaje" rows="4" placeholder="¿Cómo podemos ayudarte?"></textarea>
                </div>
            </div>
            <button type="button" class="btn" id="btnEnviarContacto">ENVIAR</button>
            <div id="contacto-msg" class="subtle" style="margin-top:.5rem;display:none;"></div>
        </div>

        <div class="card">
            <h3>Ubicación</h3>
            <div class="map-wrapper">
                <iframe
                    title="Mapa Tecmave"
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1511.2061413255587!2d-73.9796223417571!3d40.75295602669006!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c2590199a4c12d%3A0x35c4d69dd805cc5e!2sOne%20Vanderbilt!5e0!3m2!1sen!2sro!4v1674472555170!5m2!1sen!2sro"
                    width="100%" height="320" style="border:0;" allowfullscreen loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
        </div>
    </div>
</section>



@section Scripts {
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const nombre = document.getElementById('contacto-nombre');
            const email = document.getElementById('contacto-email');
            const mensaje = document.getElementById('contacto-mensaje');
            const msg = document.getElementById('contacto-msg');
            const btn = document.getElementById('btnEnviarContacto');

            if (!btn) return;

            const EMAILJS_PUBLIC_KEY = "DvkQr9T-CzO1LF4kv";

            btn.addEventListener('click', function () {
                if (!nombre.value || !email.value || !mensaje.value) {
                    msg.textContent = "Completa todos los campos para enviar tu mensaje.";
                    msg.style.color = "#c0392b";
                    msg.style.display = "block";
                    return;
                }

                msg.textContent = "Enviando mensaje...";
                msg.style.color = "#f59e0b";
                msg.style.display = "block";

                if (!window.emailjs) {
                    msg.textContent = "No se pudo cargar el servicio de correo. Inténtalo de nuevo más tarde.";
                    msg.style.color = "#c0392b";
                    return;
                }

                emailjs.send(
                    "service_lhi6zid",
                    "template_eesy2nr",
                    {
                        from_name: nombre.value,
                        reply_to: email.value,
                        subject: "Contacto desde Tecmave",
                        message: mensaje.value,
                        to_email: "theejosh2@gmail.com"
                    },
                    EMAILJS_PUBLIC_KEY
                ).then(function () {
                    msg.textContent = "Mensaje enviado correctamente. Te contactaremos pronto.";
                    msg.style.color = "#27ae60";
                    msg.style.display = "block";

                    nombre.value = "";
                    email.value = "";
                    mensaje.value = "";
                }).catch(function (error) {
                    console.error("Error al enviar el mensaje:", error);
                    msg.textContent = "Ocurrió un error al enviar el mensaje. Revisa la configuración de EmailJS.";
                    msg.style.color = "#c0392b";
                    msg.style.display = "block";
                });
            });
        });
    </script>
}
