@page
@model Front.Pages.Factura.IndexModel
@{
    ViewData["Title"] = "Facturas";
}
<section class="section">
  <div class="container grid cols-1">
    <div class="card">
      <div class="row" class="row">
        <h3 style="margin:0">Listado de Facturas</h3>
        <div class="fx-actions">
          <button id="btnExportMes" class="btn btn-primary">Exportar mes</button>
          <button id="btnExportCliente" class="btn btn-primary">Exportar por cliente</button>
          <button id="btnExportPendientes" class="btn btn-secondary">Exportar pendientes</button>
          <button id="btnEnviarRecordatorios" class="btn">Enviar recordatorios</button>
          <button id="btnAbrirModalCrear" class="btn">Generar factura</button>
          <button id="btnAbrirModalAuto" class="btn">Generar desde servicio</button>
        </div>
      </div>

      <!-- FILTROS -->
      <div class="form-row"
 >
        <div>
          <label>Número de factura</label>
          <input id="filtroNumero" class="input" placeholder="Ej: 1024" />
        </div>
        <div>
          <label>Buscar por cliente</label>
          <input id="filtroNombre" class="input" placeholder="Ingrese nombre del cliente..." />
        </div>
        <div>
          <label>Estado</label>
          <select id="filtroEstado" class="input">
            <option value="">Todos</option>
            <option value="Pagada">Pagada</option>
            <option value="Pendiente">Pendiente</option>
            <option value="Anulada">Anulada</option>
          </select>
        </div>
        <div>
          <label>Desde</label>
          <input id="filtroDesde" type="date" class="input" />
        </div>
        <div>
          <label>Hasta</label>
          <input id="filtroHasta" type="date" class="input" />
        </div>
        <div >
          <button id="btnFiltrar" class="btn btn-primary">Filtrar</button>
        </div>
      </div>

      <!-- CONTROLES DE EXPORTACIÓN -->
      <div class="form-row"
 >
        <div>
          <label>Mes a exportar</label>
          <input id="filtroMesExport" type="month" class="input" />
        </div>
        <div>
          <label>Cliente a exportar</label>
          <select id="selClienteExport" class="input"></select>
        </div>
      </div>

      <!-- TABLA -->
      <table class="table" >
        <thead>
          <tr>
            <th>ID Factura</th>
            <th>Cliente</th>
            <th>Correo</th>
            <th>Teléfono</th>
            <th>Fecha emisión</th>
            <th>Método pago</th>
            <th>Estado</th>
            <th>Total</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody id="tablaFacturas"></tbody>
      </table>

      <div class="subtle" >
        <span id="badge"></span>
      </div>
    </div>
  </div>

<!-- Modal: Crear Factura Manual -->
<div id="modalCrearFactura" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
      <h4>Generar factura manual</h4>
      <button class="close" data-close="modalCrearFactura">×</button>
    </div>
    <div class="modal-body">
      <div class="form-row"
>
        <div>
          <label>Cliente</label>
          <select id="crear_cliente" class="input"></select>
        </div>
        <div>
          <label>Método de pago</label>
          <select id="crear_metodo" class="input">
            <option>Efectivo</option>
            <option>Tarjeta</option>
            <option>Transferencia</option>
            <option>Sin definir</option>
          </select>
        </div>
        <div>
          <label>Fecha</label>
          <input id="crear_fecha" type="date" class="input" />
        </div>
        <div>
          <label>Total</label>
          <input id="crear_total" type="number" step="0.01" min="0" class="input" />
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button id="btnCrearFactura" class="btn btn-primary">Crear</button>
      <button class="btn" data-close="modalCrearFactura">Cancelar</button>
    </div>
  </div>
</div>

<!-- Modal: Crear Factura Automática desde Servicio -->
<div id="modalAutoFactura" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
      <h4>Generar factura desde servicio</h4>
      <button class="close" data-close="modalAutoFactura">×</button>
    </div>
    <div class="modal-body">
      <div class="form-row"
>
        <div>
          <label>Cliente</label>
          <select id="auto_cliente" class="input"></select>
        </div>
        <div>
          <label>Servicio</label>
          <select id="auto_servicio" class="input"></select>
        </div>
        <div>
          <label>Método de pago</label>
          <select id="auto_metodo" class="input">
            <option>Efectivo</option>
            <option>Tarjeta</option>
            <option>Transferencia</option>
            <option>Sin definir</option>
          </select>
        </div>
      </div>
      <p class="subtle">El total se tomará del precio del servicio seleccionado.</p>
    </div>
    <div class="modal-footer">
      <button id="btnCrearAuto" class="btn btn-primary">Generar</button>
      <button class="btn" data-close="modalAutoFactura">Cancelar</button>
    </div>
  </div>
</div>

</section>


